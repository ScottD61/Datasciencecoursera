{
    "contents" : "#Project 1 - Reproducible Research\n#Scott Davis\n\n#Step 1 - import and pre-process data\n\n#Import Data \nSensor <- read.csv('activity.csv')\n#Convert csv to dataframe\nSensor_activity <- data.frame(Sensor)\n\n#Data preprocessing\n#Datatypes\nstr(Sensor_activity)\n#Summary statistics\nsummary(Sensor_activity)\n\n#Step 2 - histogram of total number of steps taken each day \n#Group by date and take total\nsteps_calc <- aggregate(Sensor_activity$steps, by = list(Sensor_activity$date), FUN = 'sum')\n#Histogram total steps per day\nhist(steps_calc$x, main = \"Histogram of total steps per day\", xlab = \"total steps\", \n     ylim = c(0,30), col = \"green\")\n\n#Step 3 - mean and median of steps taken each day \nsummary(steps_calc$x)\n\n#Step 4 - time series plot of average activity pattern\n#Group by interval and take average\nsteps_calc_avg <- aggregate(steps ~ interval, Sensor_activity, mean)\n#Plot of average steps per day\nplot(steps_calc_avg$interval, steps_calc_avg$steps, type = \"l\", main = \"Average activity patterns\",\n         xlab = \"Interval\", ylab = \"Steps\") \n\n#Step 5 - maximum number of steps in 5min interval across daily average\nsteps_calc_avg[which.max(steps_calc_avg$steps), 1]\n\n#Step 6 - impute missing values\n#Number of missing values in steps variable\nsum(is.na(Sensor_activity$steps))\n\n#Imputation of data using MICE package\nlibrary(mice)\n#Apply MICE algorithm to NA dataset\nimputed_sensor <- mice(Sensor_activity, m = 5, maxit = 50, method = \"pmm\", seed = 5)\n#Get completed dataset\ncompleteData <- complete(imputed_sensor, 4)\n\n#Step 7 - histogram of total number of steps per day after imputation\n#Histogram of total number of steps per day\nna_steps_calc <- aggregate(completeData$steps, by = list(completeData$date), FUN = 'sum')\n#Histogram total steps per day\nhist(na_steps_calc$x, main = \"Histogram of total steps per day\", xlab = \"total steps\", \n     ylim = c(0,30), col = \"green\")\n\n#Mean and median of imputed dataset\nsummary(na_steps_calc$x)\n\n#Step 8 - Compare average number of steps per interval across weekdays and weekends\n#Install timeDate package\nlibrary(timeDate)\n\n#Create new column for weekday or weekend\ncompleteData$Weekday <- isWeekday(completeData$date)\n#Average steps for weekday\nweekday <- subset(completeData, completeData$Weekday == \"TRUE\")\nweekdayMean <- aggregate(steps ~ interval, data = weekday, mean)\n#Average steps for weekend\nweekend <- subset(completeData, completeData$Weekday == \"FALSE\")\nweekendMean <- aggregate(steps ~ interval, data = weekend, mean)\n\n#Plot of weekday and weekend\n#Plot of weekday\nplot(weekdayMean$interval, weekdayMean$steps,\n     xlab = \"interval\", ylab = \"Number of steps\",\n     main = \"Weekday\", col = \"blue\", type = \"l\") \n#Plot of weekend\nplot(weekendMean$interval, weekendMean$steps,\n     xlab = \"interval\", ylab = \"Number of steps\",\n     main = \"Weekend\", col = \"red\", type = \"l\")\n\n\n",
    "created" : 1457281326702.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1751452056",
    "id" : "13CB5FF5",
    "lastKnownWriteTime" : 1457304848,
    "path" : "~/datasciencecoursera/Project/Project1.R",
    "project_path" : "Project1.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}